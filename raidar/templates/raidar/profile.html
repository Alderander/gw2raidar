[[#with profile]]
  <h2>Profile: <strong>[[username]]</strong></h2>
  <p>
    Joined at: [[formatDate(joined_at)]]
  </p>
  <p>
    Encounters: [[count]]
  </p>
  <p>
    Characters: [[num_characters]]
  </p>
  <p>
    Downed time: [[summary.avg_down_percentage.toPrecision(3)]]%
  </p>
  <p>
    Dead time: [[summary.avg_dead_percentage.toPrecision(3)]]%
  </p>
  <p>
    Disconnected time: [[summary.avg_disconnect_percentage.toPrecision(3)]]%
  </p>

  <table class="uk-table uk-table-striped">
    <thead>
      <tr>
        <th>Area</th>
        <th>Count</th>
        <th>Success</th>
      </tr>
    </thead>
    <tbody>
      [[#each encounter:encounterId]]
        <tr on-click="@.set({'page.area': [[encounterId]]})">
          <td>
            <input class="uk-radio" type="radio" name="[[page.area]]" value="[[encounterId]]"/>
            [[encounterId == 'All' ? 'All' : data.areas[encounterId]]]
          </td>
          [[#with archetype.All.profession.All]]
            <td>[[count]]</td>
            <td>[[avg_success_percentage.toPrecision(3)]]%</td>
          [[/with]]
        </tr>
      [[/each]]
    </tbody>
  </table>


  [[#each encounter[page.area].archetype:archetypeId]]
  <h3>
    [[archetypeId == 'All' ? 'All' : data.archetypes[archetypeId]]]
    Archetypes on
    [[page.area == 'All' ? 'All Encounters' : data.areas[page.area]]]
  </h3>
    <table class="uk-table uk-table-striped">
      <thead>
        <tr>
          <th>Profession</th>
          <th>Encounters</th>
          <th>Avg DPS</th>
          <th>Max DPS</th>
          <th>Down</th>
          <th>Dead</th>
          <th>Disconnected</th>
        </tr>
      </thead>
      <tbody>
        [[#each profession:professionId]]
          <tr>
            <th>
              [[professionId == 'All' ? 'All' : data.specialisations[professionId][0]]]
            </th>
            <td>
              [[count]]
            </td>
            <td>
              [[avg_dps]]
            </td>
            <td>
              [[max_dps]]
            </td>
            <td>
              [[avg_down_percentage ? avg_down_percentage.toPrecision(3) + '%' : '']]
            </td>
            <td>
              [[avg_dead_percentage ? avg_dead_percentage.toPrecision(3) + '%' : '']]
            </td>
            <td>
              [[avg_disconnect_percentage ? avg_disconnect_percentage.toPrecision(3) + '%' : '']]
            </td>
          </tr>
        [[/each]]
      </tbody>
    </table>
  [[/each]]
[[/with]]
