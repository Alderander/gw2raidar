{% load staticfiles %}
<table class="uk-table uk-table-striped">
  <thead>
    <tr>
      <th class="uk-width-auto" on-click="sort_encounters" data-sort="area:up">
        Area
        [[#if settings.encounterSort.prop != 'area']]
          <span uk-icon="icon: minus"></span>
        [[elseif settings.encounterSort.dir == 'up']]
          <span uk-icon="icon: chevron-up"></span>
        [[else]]
          <span uk-icon="icon: chevron-down"></span>
        [[/if]]
      </th>
      <th class="uk-width-auto" on-click="sort_encounters" data-sort="started_at:down">
        Time
        [[#if settings.encounterSort.prop != 'started_at']]
          <span uk-icon="icon: minus"></span>
        [[elseif settings.encounterSort.dir == 'up']]
          <span uk-icon="icon: chevron-up"></span>
        [[else]]
          <span uk-icon="icon: chevron-down"></span>
        [[/if]]
      </th>
      <th class="uk-width-auto" on-click="sort_encounters" data-sort="duration:down">
        Dur.
        [[#if settings.encounterSort.prop != 'duration']]
          <span uk-icon="icon: minus"></span>
        [[elseif settings.encounterSort.dir == 'up']]
          <span uk-icon="icon: chevron-up"></span>
        [[else]]
          <span uk-icon="icon: chevron-down"></span>
        [[/if]]
      </th>
      <th class="uk-width-auto" on-click="sort_encounters" data-sort="character:up">
        Character
        [[#if settings.encounterSort.prop != 'character']]
          <span uk-icon="icon: minus"></span>
        [[elseif settings.encounterSort.dir == 'up']]
          <span uk-icon="icon: chevron-up"></span>
        [[else]]
          <span uk-icon="icon: chevron-down"></span>
        [[/if]]
      </th>
      <th class="uk-width-auto" on-click="sort_encounters" data-sort="account:up">
        Account
        [[#if settings.encounterSort.prop != 'account']]
          <span uk-icon="icon: minus"></span>
        [[elseif settings.encounterSort.dir == 'up']]
          <span uk-icon="icon: chevron-up"></span>
        [[else]]
          <span uk-icon="icon: chevron-down"></span>
        [[/if]]
      </th>
      <th class="uk-width-auto" on-click="sort_encounters" data-sort="uploaded_at:down">
        Upload
        [[#if settings.encounterSort.prop != 'uploaded_at']]
          <span uk-icon="icon: minus"></span>
        [[elseif settings.encounterSort.dir == 'up']]
          <span uk-icon="icon: chevron-up"></span>
        [[else]]
          <span uk-icon="icon: chevron-down"></span>
        [[/if]]
        <div class="uk-float-right" on-click="encounter_filter_toggle">
          [[#if settings.encounterSort.filters]]
            <span uk-tooltip title="Remove filters" uk-icon="icon: close"></span>
          [[else]]
            <span uk-tooltip title="Filters" uk-icon="icon: search"></span>
          [[/if]]
        </div>
      </th>
    </tr>

    [[#if settings.encounterSort.filters]]
      <tr>
        <th>
          <div class="uk-button-group">
            <button class="uk-button uk-button-default uk-button-small [[settings.encounterSort.filter.success === true && 'uk-button-primary' || '']]" value="true" on-click="encounter_filter_success"><span uk-icon="icon: check"></span></button>
            <button class="uk-button uk-button-default uk-button-small [[settings.encounterSort.filter.success === null && 'uk-button-primary' || '']]" value="null" on-click="encounter_filter_success"></button>
            <button class="uk-button uk-button-default uk-button-small [[settings.encounterSort.filter.success === false && 'uk-button-primary' || '']]" value="false" on-click="encounter_filter_success"><span uk-icon="icon: close"></span></button>
          </div><br/>
          <input class="uk-input uk-form-small" value="[[settings.encounterSort.filter.area]]" placeholder="Starts with" list="encountersAreas">
          <datalist id="encountersAreas">
            [[#each encountersAreas]]
              <option value="[[.]]"/>
            [[/each]]
          </datalist>
        </th>
        <th>
          <input class="uk-input uk-form-small" value="[[settings.encounterSort.filter.started_from]]" placeholder="From" type="date"><br>
          <input class="uk-input uk-form-small" value="[[settings.encounterSort.filter.started_till]]" placeholder="Till" type="date">
        </th>
        <th>
          <input class="uk-input uk-form-small" value="[[settings.encounterSort.filter.duration_from]]" placeholder="From"><br>
          <input class="uk-input uk-form-small" value="[[settings.encounterSort.filter.duration_till]]" placeholder="Till">
        </th>
        <th>
          <input class="uk-input uk-form-small" value="[[settings.encounterSort.filter.character]]" placeholder="Starts with" list="encountersCharacters">
          <datalist id="encountersCharacters">
            [[#each encountersCharacters]]
              <option value="[[.]]"/>
            [[/each]]
          </datalist>
        </th>
        <th>
          <input class="uk-input uk-form-small" value="[[settings.encounterSort.filter.account]]" placeholder="Starts with" list="encountersAccounts">
          <datalist id="encountersAccounts">
            [[#each encountersAccounts]]
              <option value="[[.]]"/>
            [[/each]]
          </datalist>
        </th>
        <th>
          <input class="uk-input uk-form-small" value="[[settings.encounterSort.filter.uploaded_from]]" placeholder="From" type="date"><br>
          <input class="uk-input uk-form-small" value="[[settings.encounterSort.filter.uploaded_till]]" placeholder="Till" type="date">
        </th>
      </tr>
    [[/if]]
  </thead>

  [[#each encounterSlice]]
    <tr on-click="@this.page({ name: 'encounter', no: id })">
      <td class="[[success ? 'uk-text-success' : 'uk-text-danger']]">
        [[area]]
      </td>
      <td>
        [[formatDate(started_at)]]
      </td>
      <td>
        &#91;[[formatTime(duration)]]&#93;
      </td>
      <td>
        <img alt="[[data.archetypes[archetype]]]" src="{% static 'raidar/img/arch/' %}/[[data.archetypes[archetype]]].png"/>
        <img alt="[[data.specialisations[profession][elite]]]" src="{% static 'raidar/img/20px/' %}/[[data.specialisations[profession][elite]]]_tango_icon_20px.png"/>
        [[character]]
      </td>
      <td>
        [[account]]
      </td>
      <td>
        [[formatDate(uploaded_at)]]
      </td>
    </tr>
  [[/each]]
</table>

<hr class="uk-divider-icon">
<ul class="uk-pagination uk-flex-center">
  [[#each encounterPages]]
    [[#if a || d]]
      <li class="[[a ? 'uk-active' : 'uk-disabled']]"><span class="[[c]]">[[t]]</span></li>
    [[else]]
      <li><a href="#" class="[[c]]" data-page="[[n || t]]" on-click="page_no">[[t]]</a></li>
    [[/if]]
  [[/each]]
</ul>
